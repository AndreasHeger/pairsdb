from distutils.core import setup
from distutils.extension import Extension
import os.path
import sys, glob, re, shutil

def main():

    include_dirs = re.findall( "-I\s*(\S+)", "@BOOST_CPPFLAGS@ @ALIGNLIB_CFLAGS@ @MYSQL_CFLAGS@" ) +\
        [".","../pairsdblib", ".." ]

    libraries=filter( lambda x: x != "", ["@BOOST_PYTHON_LIB@", "pairsdblib"] )
    library_dirs=[ "../pairsdblib/.libs" ]

    files = glob.glob( "modules/*.cpp" )

    setup(name="pairsdblib",    
          version='1.0',
          description="pairsdb utility functions in python",
          author='Andreas Heger',
          author_email='andreas.heger@gmail.com',
          ext_modules=[
                       Extension("pairsdblib",
                             files,
                             library_dirs=library_dirs,
                             libraries=libraries,
                             include_dirs=include_dirs,
                             depends=[]),
                             ],
          data_files = [ ('include/pairsdblib', ('exposed_decl.pypp.txt',)) ],
          )

if __name__ == "__main__":
    sys.exit(main())
